# 样式隔离方案总结

在微前端架构中，子应用需要确保其样式不会与主应用或其他子应用产生冲突。本文档总结了常见的样式隔离方案，并说明本项目采用的推荐方案。

## 常见样式隔离方案

### 1. CSS Modules
- **原理**：为类名生成唯一的哈希值，如 `.container__abc123`
- **优点**：提供强隔离，避免命名冲突
- **缺点**：需要特殊语法引用类名
- **适用场景**：对样式隔离要求严格的组件

### 2. Scoped CSS
- **原理**：为组件添加唯一属性选择器，如 `[data-v-123456]`
- **优点**：使用简单，直接使用类名
- **缺点**：隔离强度相对较弱
- **适用场景**：简单的静态样式组件

### 3. CSS 命名空间前缀
- **原理**：为应用样式添加特定前缀，如 `.sub-app .container`
- **优点**：实现简单，易于理解和维护
- **缺点**：需要规范团队命名约定
- **适用场景**：全局样式隔离

### 4. BEM 命名规范
- **原理**：采用块（Block）、元素（Element）、修饰符（Modifier）命名约定
- **优点**：提高代码可读性和可维护性
- **缺点**：需要团队统一规范
- **适用场景**：大型项目中的样式命名

### 5. Shadow DOM
- **原理**：使用浏览器原生的 Shadow DOM 实现样式隔离
- **优点**：最强的样式隔离能力
- **缺点**：兼容性问题，实现复杂
- **适用场景**：对样式隔离要求极高的场景

### 6. qiankun 样式隔离
- **原理**：利用 qiankun 提供的沙箱机制实现样式隔离
- **优点**：与微前端框架深度集成
- **缺点**：可能存在性能开销
- **适用场景**：qiankun 微前端架构

## 本项目采用的推荐方案

本项目采用了多种样式隔离方案的组合，以确保最佳的隔离效果：

### 子应用
1. **CSS Modules**：在 Vite 配置中启用 CSS Modules，为类名生成唯一哈希值
2. **Scoped CSS**：在 Vue 组件中使用 scoped CSS 实现组件级别隔离
3. **BEM 命名规范**：采用 BEM 命名规范确保类名唯一性

### 主应用
1. **CSS 命名空间前缀**：为主应用的所有样式添加 `.main-app` 前缀
2. **Scoped CSS**：在 Vue 组件中使用 scoped CSS 实现组件级别隔离
3. **qiankun 实验性样式隔离**：启用 qiankun 的 experimentalStyleIsolation 选项

## 实施效果

通过以上方案的组合使用，本项目有效解决了子应用与主应用或其他子应用之间的样式冲突问题：
1. 子应用的样式通过 CSS Modules 实现局部化
2. 主应用的样式通过命名空间前缀避免全局污染
3. qiankun 的样式隔离机制进一步确保了样式隔离
4. Scoped CSS 确保组件级别的样式隔离

## 最佳实践

1. **子应用优先使用 CSS Modules**：对于需要动态类名的组件，优先使用 CSS Modules
2. **主应用优先使用命名空间前缀**：为主应用的全局样式添加特定前缀
3. **组件级别隔离**：在组件级别使用 scoped 或 CSS Modules
4. **第三方组件库处理**：对 Element Plus 等第三方组件库使用命名空间包装
5. **样式变量管理**：使用 CSS 自定义属性隔离主题变量